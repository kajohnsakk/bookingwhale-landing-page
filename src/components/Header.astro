---
import LanguageSwitcher from "./LanguageSwitcher.astro";
---

<header
  class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-lg shadow-md z-50 border-b border-gray-200/50"
>
  <nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-2 sm:py-3 lg:py-3">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <a href="/" class="flex items-center space-x-2">
          <!-- logo svg from /favicon.svg -->
          <img
            src="/logo.png"
            alt="BookingWhale logo - LINE OA booking system for businesses in Thailand"
            class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg hover:scale-105 transition-transform duration-200"
          />
        </a>
        <!-- <span class="text-2xl font-bold text-gray-900">BookingWhale</span> -->
      </div>

      <!-- Desktop Menu -->
      <div class="hidden md:flex items-center space-x-6 lg:space-x-8">
        <a
          href="#services"
          data-translate="ourServices"
          class="text-gray-600 hover:text-blue-600 transition-all duration-200 font-medium relative group text-sm lg:text-base"
          title="เรียนรู้เหตุผลที่ต้องเลือก BookingWhale สำหรับธุรกิจของคุณ"
        >
          Why Booking Whale
          <span
            class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-200 group-hover:w-full"
          ></span>
        </a>
        <a
          href="#features"
          data-translate="whyChoose"
          class="text-gray-600 hover:text-blue-600 transition-all duration-200 font-medium relative group text-sm lg:text-base"
          title="ดูฟีเจอร์ครบครันของ BookingWhale ที่จะช่วยเพิ่มประสิทธิภาพธุรกิจ"
        >
          ฟีเจอร์ของเรา
          <span
            class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-200 group-hover:w-full"
          ></span>
        </a>
        <a
          href="#faq"
          data-translate="faq"
          class="text-gray-600 hover:text-blue-600 transition-all duration-200 font-medium relative group text-sm lg:text-base"
          title="คำตอบสำหรับคำถามที่พบบ่อยเกี่ยวกับ BookingWhale"
        >
          คำถามที่พบบ่อย
          <span
            class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-200 group-hover:w-full"
          ></span>
        </a>
        <a
          href="#blog"
          data-translate="blog"
          class="text-gray-600 hover:text-blue-600 transition-all duration-200 font-medium relative group text-sm lg:text-base"
          title="อ่านบทความและเคล็ดลับการเพิ่มประสิทธิภาพธุรกิจ"
        >
          บทความ
          <span
            class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-200 group-hover:w-full"
          ></span>
        </a>
        <a
          href="#contact"
          data-translate="contact"
          class="text-gray-600 hover:text-blue-600 transition-all duration-200 font-medium relative group text-sm lg:text-base"
          title="ติดต่อทีมงาน BookingWhale สำหรับความช่วยเหลือ"
        >
          ติดต่อ
          <span
            class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-200 group-hover:w-full"
          ></span>
        </a>
        <LanguageSwitcher />
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden flex items-center space-x-3">
        <LanguageSwitcher />
        <button
          id="mobileMenuToggle"
          class="p-2 text-gray-600 hover:text-gray-900 transition-colors relative w-8 h-8 flex flex-col justify-center items-center hover:bg-gray-100 rounded-lg"
          aria-label="Toggle menu"
        >
          <span
            class="hamburger-line block w-5 h-0.5 bg-current transition-all duration-300 ease-out"
          ></span>
          <span
            class="hamburger-line block w-5 h-0.5 bg-current transition-all duration-300 ease-out mt-1"
          ></span>
          <span
            class="hamburger-line block w-5 h-0.5 bg-current transition-all duration-300 ease-out mt-1"
          ></span>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobileMenu"
      class="md:hidden overflow-hidden transition-all duration-300 ease-out max-h-0 opacity-0"
    >
      <div class="pt-4 pb-6 border-t border-gray-200/70 mt-4 bg-white/50 backdrop-blur-sm rounded-b-xl">
        <div class="flex flex-col space-y-4">
          <a
            href="#services"
            data-translate="ourServices"
            class="mobile-menu-link text-gray-700 hover:text-blue-600 transition-colors font-medium py-3 px-4 rounded-xl hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            Why Booking Whale
          </a>
          <a
            href="#features"
            data-translate="whyChoose"
            class="mobile-menu-link text-gray-700 hover:text-blue-600 transition-colors font-medium py-3 px-4 rounded-xl hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            ฟีเจอร์ของเรา
          </a>
          <a
            href="#faq"
            data-translate="faq"
            class="mobile-menu-link text-gray-700 hover:text-blue-600 transition-colors font-medium py-3 px-4 rounded-xl hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            คำถามที่พบบ่อย
          </a>
          <a
            href="#blog"
            data-translate="blog"
            class="mobile-menu-link text-gray-700 hover:text-blue-600 transition-colors font-medium py-3 px-4 rounded-xl hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            บทความ
          </a>
          <a
            href="#contact"
            data-translate="contact"
            class="mobile-menu-link text-gray-700 hover:text-blue-600 transition-colors font-medium py-3 px-4 rounded-xl hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            ติดต่อ
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  let isMobileMenuOpen = false;

  function toggleMobileMenu() {
    const mobileMenu = document.getElementById("mobileMenu");
    const mobileMenuToggle = document.getElementById("mobileMenuToggle");
    const hamburgerLines =
      mobileMenuToggle?.querySelectorAll(".hamburger-line");

    isMobileMenuOpen = !isMobileMenuOpen;

    if (isMobileMenuOpen) {
      // Open menu
      mobileMenu?.classList.remove("max-h-0", "opacity-0");
      mobileMenu?.classList.add("max-h-96", "opacity-100");

      // Animate hamburger to X
      if (hamburgerLines) {
        hamburgerLines[0].style.transform = "rotate(45deg) translate(5px, 5px)";
        hamburgerLines[1].style.opacity = "0";
        hamburgerLines[2].style.transform =
          "rotate(-45deg) translate(7px, -6px)";
      }
    } else {
      // Close menu
      mobileMenu?.classList.add("max-h-0", "opacity-0");
      mobileMenu?.classList.remove("max-h-96", "opacity-100");

      // Reset hamburger
      if (hamburgerLines) {
        hamburgerLines[0].style.transform = "none";
        hamburgerLines[1].style.opacity = "1";
        hamburgerLines[2].style.transform = "none";
      }
    }
  }

  function closeMobileMenu() {
    if (isMobileMenuOpen) {
      toggleMobileMenu();
    }
  }

  // Event listeners
  document
    .getElementById("mobileMenuToggle")
    ?.addEventListener("click", toggleMobileMenu);

  // Close mobile menu when clicking outside
  document.addEventListener("click", (e) => {
    const header = document.querySelector("header");
    if (!header?.contains(e.target) && isMobileMenuOpen) {
      closeMobileMenu();
    }
  });

  // Close mobile menu on window resize to desktop
  window.addEventListener("resize", () => {
    if (window.innerWidth >= 768 && isMobileMenuOpen) {
      closeMobileMenu();
    }
  });

  // Smooth scrolling for anchor links
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute("href"));
      if (target) {
        const headerHeight = 80;
        const targetPosition = target.offsetTop - headerHeight;

        window.scrollTo({
          top: targetPosition,
          behavior: "smooth",
        });
      }
    });
  });

  // Header background on scroll
  window.addEventListener("scroll", () => {
    const header = document.querySelector("header");
    if (window.scrollY > 50) {
      header?.classList.add("bg-white/98", "shadow-lg");
      header?.classList.remove("bg-white/95", "shadow-md");
    } else {
      header?.classList.add("bg-white/95", "shadow-md");
      header?.classList.remove("bg-white/98", "shadow-lg");
    }
  });

  // Make functions globally available
  window.toggleMobileMenu = toggleMobileMenu;
  window.closeMobileMenu = closeMobileMenu;
</script>

<style>
  .hamburger-line {
    transform-origin: center;
  }

  #mobileMenu {
    transition:
      max-height 0.3s ease-out,
      opacity 0.3s ease-out;
  }

  .mobile-menu-link {
    transition: all 0.2s ease;
  }

  @media (max-width: 768px) {
    .language-switcher {
      position: static;
    }

    .language-switcher #languageDropdown {
      right: 0;
      left: auto;
    }
  }
</style>
