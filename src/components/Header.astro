---
import LanguageSwitcher from './LanguageSwitcher.astro';
---

<header class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-sm border-b border-gray-100 z-50">
  <nav class="container mx-auto px-4 py-4">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg">
          <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2l8 3v7c0 5.55-3.84 10.74-9 12-5.16-1.26-9-6.45-9-12V5l8-3z"/>
            <path d="M9.5 11L8 12.5l3 3 6-6L15.5 8 11 12.5l-1.5-1.5z" fill="rgba(255,255,255,0.3)"/>
            <circle cx="12" cy="7" r="1.5" fill="rgba(255,255,255,0.4)"/>
          </svg>
        </div>
        <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">BookingWhale</span>
      </div>
      
      <!-- Desktop Menu -->
      <div class="hidden md:flex items-center space-x-8">
        <a href="#services" data-translate="services" class="text-gray-600 hover:text-blue-600 transition-all duration-300 font-medium relative group">
          Services
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 transition-all duration-300 group-hover:w-full"></span>
        </a>
        <a href="#features" data-translate="features" class="text-gray-600 hover:text-blue-600 transition-all duration-300 font-medium relative group">
          Features
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 transition-all duration-300 group-hover:w-full"></span>
        </a>
        <a href="#contact" data-translate="contact" class="text-gray-600 hover:text-blue-600 transition-all duration-300 font-medium relative group">
          Contact
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 transition-all duration-300 group-hover:w-full"></span>
        </a>
        <LanguageSwitcher />
        <button 
          onclick="openBookingModal()" 
          data-translate="bookNow"
          class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2.5 rounded-xl hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-300 font-medium transform hover:-translate-y-0.5"
        >
          Book Now
        </button>
      </div>
      
      <!-- Mobile Menu Button -->
      <div class="md:hidden flex items-center space-x-3">
        <LanguageSwitcher />
        <button 
          id="mobileMenuToggle"
          class="p-2 text-gray-600 hover:text-blue-600 transition-colors relative w-8 h-8 flex flex-col justify-center items-center"
          aria-label="Toggle menu"
        >
          <span class="hamburger-line block w-5 h-0.5 bg-current transition-all duration-300 ease-out"></span>
          <span class="hamburger-line block w-5 h-0.5 bg-current transition-all duration-300 ease-out mt-1"></span>
          <span class="hamburger-line block w-5 h-0.5 bg-current transition-all duration-300 ease-out mt-1"></span>
        </button>
      </div>
    </div>
    
    <!-- Mobile Menu -->
    <div 
      id="mobileMenu" 
      class="md:hidden overflow-hidden transition-all duration-300 ease-out max-h-0 opacity-0"
    >
      <div class="pt-4 pb-6 border-t border-gray-100 mt-4">
        <div class="flex flex-col space-y-4">
          <a 
            href="#services" 
            data-translate="services"
            class="mobile-menu-link text-gray-600 hover:text-blue-600 transition-colors font-medium py-2 px-2 rounded-lg hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            Services
          </a>
          <a 
            href="#features" 
            data-translate="features"
            class="mobile-menu-link text-gray-600 hover:text-blue-600 transition-colors font-medium py-2 px-2 rounded-lg hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            Features
          </a>
          <a 
            href="#contact" 
            data-translate="contact"
            class="mobile-menu-link text-gray-600 hover:text-blue-600 transition-colors font-medium py-2 px-2 rounded-lg hover:bg-blue-50"
            onclick="closeMobileMenu()"
          >
            Contact
          </a>
          <button 
            onclick="openBookingModal(); closeMobileMenu();" 
            data-translate="bookNow"
            class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl hover:shadow-lg transition-all duration-300 font-medium w-full mt-4"
          >
            Book Now
          </button>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  let isMobileMenuOpen = false;
  
  function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const hamburgerLines = mobileMenuToggle?.querySelectorAll('.hamburger-line');
    
    isMobileMenuOpen = !isMobileMenuOpen;
    
    if (isMobileMenuOpen) {
      // Open menu
      mobileMenu?.classList.remove('max-h-0', 'opacity-0');
      mobileMenu?.classList.add('max-h-96', 'opacity-100');
      
      // Animate hamburger to X
      if (hamburgerLines) {
        hamburgerLines[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
        hamburgerLines[1].style.opacity = '0';
        hamburgerLines[2].style.transform = 'rotate(-45deg) translate(7px, -6px)';
      }
    } else {
      // Close menu
      mobileMenu?.classList.add('max-h-0', 'opacity-0');
      mobileMenu?.classList.remove('max-h-96', 'opacity-100');
      
      // Reset hamburger
      if (hamburgerLines) {
        hamburgerLines[0].style.transform = 'none';
        hamburgerLines[1].style.opacity = '1';
        hamburgerLines[2].style.transform = 'none';
      }
    }
  }
  
  function closeMobileMenu() {
    if (isMobileMenuOpen) {
      toggleMobileMenu();
    }
  }
  
  // Event listeners
  document.getElementById('mobileMenuToggle')?.addEventListener('click', toggleMobileMenu);
  
  // Close mobile menu when clicking outside
  document.addEventListener('click', (e) => {
    const header = document.querySelector('header');
    if (!header?.contains(e.target) && isMobileMenuOpen) {
      closeMobileMenu();
    }
  });
  
  // Close mobile menu on window resize to desktop
  window.addEventListener('resize', () => {
    if (window.innerWidth >= 768 && isMobileMenuOpen) {
      closeMobileMenu();
    }
  });
  
  // Smooth scrolling for anchor links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        const headerHeight = 80;
        const targetPosition = target.offsetTop - headerHeight;
        
        window.scrollTo({
          top: targetPosition,
          behavior: 'smooth'
        });
      }
    });
  });

  // Header background on scroll
  window.addEventListener('scroll', () => {
    const header = document.querySelector('header');
    if (window.scrollY > 100) {
      header?.classList.add('bg-white/95');
      header?.classList.remove('bg-white/90');
    } else {
      header?.classList.add('bg-white/90');
      header?.classList.remove('bg-white/95');
    }
  });
  
  // Make functions globally available
  window.toggleMobileMenu = toggleMobileMenu;
  window.closeMobileMenu = closeMobileMenu;
</script>

<style>
  .hamburger-line {
    transform-origin: center;
  }
  
  #mobileMenu {
    transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
  }
  
  .mobile-menu-link {
    transition: all 0.2s ease;
  }
  
  @media (max-width: 768px) {
    .language-switcher {
      position: static;
    }
    
    .language-switcher #languageDropdown {
      right: 0;
      left: auto;
    }
  }
</style>